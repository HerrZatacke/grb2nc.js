(()=>{var t={8999:(t,e,r)=>{"use strict";var s=r(7922),a=r(998),i=r(9690),n=r(7249),o=r(1863),l=r(1739);let h=async t=>new Promise(e=>{self.setTimeout(e,t)}),c=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return Math.abs(t.X-e.X)<r&&Math.abs(t.Y-e.Y)<r};var p=function(t){return t.ISOLATION="isolation",t.EDGE_CUT="edgecut",t.DRILL="drill",t.DRAWING="drawing",t}({}),u=function(t){return t.MILLIMETERS="mm",t.INCHES="in",t}({}),d=function(t){return t.TOP="top",t.BOTTOM="bottom",t.OTHER="other",t}({}),g=function(t){return t.AREA="area",t.OUTLINE="outline",t}({});let f=t=>{let e=t[0];return c(e,t[t.length-1])?t:[...t,e]},m=Math.PI,y=Math.PI/2,E=1.5*Math.PI,w=2*Math.PI;class T{run(t,e){return this.clipper.Clear(),this.edgePolygons=[],this.drillCircles=[],t.children.forEach(t=>{switch(t.type){case"imageShape":this.drawShape(t.shape,e);break;case"imagePath":this.drawPath(t,e);break;case"imageRegion":this.drawRegion(t);break;default:console.error("not implemented type")}}),e===p.EDGE_CUT&&(t=>{if(0===t.length)return[];let e=t.map(t=>[...t]),r=[],s=e.shift();for(;e.length>0;){if(!s)throw Error("No current path");let t=s[0],a=s[s.length-1];if(c(t,a)){r.push(s),s=e.shift();continue}let i=!1;for(let r=0;r<e.length;r++){let n=e[r],o=n[0],l=n[n.length-1];if(c(a,o)?(s.push(...n),i=!0):c(a,l)?(s.push(...n.reverse()),i=!0):c(t,l)?(s.unshift(...n),i=!0):c(t,o)&&(s.unshift(...n.reverse()),i=!0),i){e.splice(r,1);break}}if(!i){r.push(s),s=e.shift();continue}}return s&&r.push(s),r})(this.edgePolygons).forEach(t=>{this.addPolygon(t,!0)}),this.finalize(e)}drawShape(t,e){switch(t.type){case"rectangle":{let e=t.x,r=t.y,s=t.xSize,a=t.ySize,i=Math.max(t.r||0,this.minimumRadius),n=this.createArc(e+i,r+i,i,m,E),o=this.createArc(e+s-i,r+i,i,E,w),l=[...n,...o,...this.createArc(e+s-i,r+a-i,i,0,y),...this.createArc(e+i,r+a-i,i,y,m),n[0]];this.addPolygon(l,!1);break}case"circle":{e===p.DRILL&&this.drillCircles.push(t);let r=t.cx,s=t.cy,a=t.r,i=this.createArc(r,s,a,0,w);i.push(i[0]),this.addPolygon(i,!1);break}case"polygon":if(t.points&&t.points.length>1){if(!t.points||!t.points.length)return;let e=[];t.points.forEach(t=>{let[r,s]=t;e.push({X:r,Y:s})}),e.push({...e[0]}),e.length>2&&this.addPolygon(e,!1)}break;case"layeredShape":t.shapes&&t.shapes.forEach(t=>this.drawShape(t,e));break;default:console.log('unknown shapetype "'.concat(t.type,'"'),t)}}drawPath(t,e){if(!t.segments||!t.segments.length)return;let r=Math.max(t.width||1);t.segments.forEach(t=>{switch(t.type){case"line":switch(e){case p.ISOLATION:{let[e,s]=t.start,[a,i]=t.end,n=Math.atan2(i-s,a-e),o=r/2,l=this.createArc(e,s,o,n+y,n-y+w),h=[...l,...this.createArc(a,i,o,n-y,n+y),l[0]].map(t=>({X:t.X,Y:t.Y}));this.addPolygon(h,!1);break}case p.EDGE_CUT:{let[e,r]=t.start,[s,a]=t.end;this.edgePolygons.push([{X:e,Y:r},{X:s,Y:a}])}}break;case"arc":{let[r,s]=t.center,[a,i,n]=t.start,[o,l,h]=t.end,c=[{X:a,Y:i},...this.createArc(r,s,t.radius,n,h),{X:o,Y:l}];switch(e){case p.ISOLATION:this.addPolygon(c,!1);break;case p.EDGE_CUT:this.edgePolygons.push(c)}}}})}drawRegion(t){if(!t.segments||!t.segments.length)return;let e=[];t.segments.forEach((t,r)=>{0===r&&e.push({X:t.start[0],Y:t.start[1]}),e.push({X:t.end[0],Y:t.end[1]})}),e.push(e[0]),e.length>2&&this.addPolygon(e,!1)}createArc(t,e,r,s,a){let i=Math.max(8,Math.min(Math.pow(2,Math.ceil(Math.log2(Math.abs(a-s)*r/.02))),64)),n=[],o=(a-s)/(i-1);for(let a=0;a<i;a++){let i=s+a*o;n.push({X:t+r*Math.cos(i),Y:e+r*Math.sin(i)})}return n}addPolygon(t,e){new n.Clipper().Clear();let r=t.map(t=>{let{X:e,Y:r}=t;return{X:Math.round(e*this.scale),Y:Math.round(r*this.scale)}});e||n.Clipper.Orientation(r)||r.reverse(),this.clipper.AddPath(r,n.PolyType.ptSubject,!0)}finalize(t){let e=[],r=t===p.EDGE_CUT?n.PolyFillType.pftEvenOdd:n.PolyFillType.pftNonZero;return this.clipper.Execute(n.ClipType.ctUnion,e,r,r),{polygons:e.map(f),drills:this.drillCircles}}getScale(){return this.scale}constructor(t,e=1){(0,s._)(this,"clipper",new n.Clipper),(0,s._)(this,"edgePolygons",[]),(0,s._)(this,"drillCircles",[]),(0,s._)(this,"scale",0),(0,s._)(this,"minimumRadius",0),(0,s._)(this,"precision",1e4),this.scale=e*this.precision,this.minimumRadius=t}}let k=new T(.05),C=t=>({bottom:-t,left:t,right:-t,top:t}),b=parseInt("1000",10),M=(t,e,r)=>"".concat(t).concat(e.toFixed(2)," ").concat(r.toFixed(2)),P=(t,e)=>t.reduce((t,r)=>[...t,r.map((t,r)=>M(r?"L":"M",b*t.X/e,b*t.Y/e)).join(" ")],[]),I=t=>{switch(t){case p.EDGE_CUT:return(.1*b).toFixed(2);case p.ISOLATION:return(.015*b).toFixed(2);case p.DRILL:return(.025*b).toFixed(2);default:return"0"}},O=(t,e)=>{let r=new n.ClipperOffset,s=[];t.forEach(t=>{r.AddPath(t,n.JoinType.jtRound,n.EndType.etClosedPolygon)});let a=[];return r.Execute(a,e),a.length>0&&s.push(...a),s},v=(t,e)=>{let r=!1;for(let s of e){let e=n.Clipper.Orientation(s);if(0!==n.Clipper.PointInPolygon(t,s))if(!e)return!1;else r=!0}return r},x=(t,e)=>t.map(t=>{let r=[],s=[];for(let a of t)v(a,e)?s.push(a):s.length>0&&(r.push(s),s=[]);return s.length>0&&r.push(s),r.length>0?r:[]}).flat(),L=new Map([]),_=async t=>{let{offsetSteps:e,offsetDistance:r,initialPath:s,taskType:a,boardEdgeOffset:i,progressTick:n,progressAddEstimate:o}=t,h=k.getScale(),c=(0,l.tW)(t);if(L.has(c))return L.get(c);let u=[];if(e){let t=r?e:1,l=s;o(t);for(let e=0;e<t;e+=1){let t=O(l,r*h).map(f),e=a!==p.EDGE_CUT&&i?x(t,i):t;u.push(e),l=t,await n()}}return L.set(c,u),u},A=t=>async e=>{let{scale:r,timings:s,boardEdgeOffset:a,progressTick:i,progressAddEstimate:n}=t,{polygons:o,drills:l,type:h,fileName:c,layer:u,steps:f,offset:m}=e,y=((t,e)=>{if(t===p.EDGE_CUT)return"edgecut";if(t===p.DRILL)return"drill";if(t===p.DRAWING)return"drawing";switch(e){case d.BOTTOM:return"bottom";case d.TOP:return"top"}return"drawing"})(h,u),E=performance.now(),w=[{path:P(o,r).join("\n"),fill:"var(--color-fill-".concat(y,")"),stroke:"var(--color-stroke-".concat(y,")"),strokeWidth:(.01*b).toFixed(2),fileName:c,pathType:g.AREA}],T=performance.now()-E,k=performance.now();await i();let C=await _({boardEdgeOffset:a,initialPath:o,offsetDistance:m,offsetSteps:f,taskType:h,progressTick:i,progressAddEstimate:n});await i();let O=performance.now()-k,v=performance.now();h===p.DRILL?w.push(...l.map(t=>({path:(t=>{let e=b*t.cx,r=b*t.cy,s=b*t.r;return[M("M",e-s,r),M("L",e+s,r),M("M",e,r-s),M("L",e,r+s)].join(" ")})(t),fill:"none",stroke:"var(--color-path-".concat(y,")"),strokeWidth:I(h),fileName:c,pathType:g.OUTLINE}))):w.push(...C.map(t=>P(t,r).map(t=>({path:t,fill:"none",stroke:"var(--color-path-".concat(y,")"),strokeWidth:I(h),fileName:c,pathType:g.OUTLINE}))).flat()),await i();let x=performance.now()-v,L=T+O+x;return s.push("Rendering ".concat(h," polygons to paths took total ").concat(L.toFixed(2),"ms:"),"  Polygons to Path: ".concat(T.toFixed(2),"ms"),"  Clipper Offsets (".concat(f," steps): ").concat(O.toFixed(2),"ms"),"  Paths Offset SVG Paths: ".concat(x.toFixed(2),"ms")),{...e,svgPathProps:w,offsetPaths:C}};class S{setup(t,e){this.progressCallback=t,this.errorCallback=e}async calculate(t){let e,{tasks:r,scale:s}=t;if(this.progressCount=0,this.progressEstimate=0,this.progressAddEstimate(3),!r.length)return await h(1),this.progressCallback(0),{renderedTasks:[],bounds:C(0),units:u.MILLIMETERS,timings:["No tasks, nothing to do."]};let o=(0,l.tW)(t);if(this.resultMap.has(o))return await h(1),this.progressCallback(0),this.resultMap.get(o);let c=[],d=r.map(t=>{try{let e=(0,a.qg)(t.fileContent),r=e.children.find(t=>{let{type:e}=t;return e===a.QN}),s=r&&"in"===r.units?u.INCHES:u.MILLIMETERS,n=(0,i.QI)(e),o=k.run(n,t.type);return{...t,...o,units:s}}catch(t){this.errorCallback(t.message)}return null}).filter(Boolean);this.progressAddEstimate(3*d.length),await this.progressTick();let g=d.find(t=>{let{type:e}=t;return e===p.EDGE_CUT}),f=null==g?void 0:g.polygons;e=g?n.Clipper.GetBounds(g.polygons):d.reduce((t,e)=>{let{polygons:r}=e,s=n.Clipper.GetBounds(r);return{bottom:Math.max(t.bottom,s.bottom),left:Math.min(t.left,s.left),right:Math.max(t.right,s.right),top:Math.min(t.top,s.top)}},C(1/0));let m=d.reduce((t,e)=>{let{fileName:r,units:s}=e;return(s===u.INCHES&&this.errorCallback("".concat(r," is using inches, which is currently not supported")),null===t)?s:t},null)||u.MILLIMETERS;await this.progressTick();let y=[];for(let t=0;t<d.length;t++){let e={...d[t]},r=await A({scale:s,timings:c,boardEdgeOffset:f,progressTick:this.progressTick,progressAddEstimate:this.progressAddEstimate})(e);y.push(r)}await this.progressTick();let E={bounds:e,units:m,renderedTasks:y,timings:c};return this.resultMap.set(o,E),await h(1),this.progressCallback(0),E}constructor(){(0,s._)(this,"progressCallback",()=>{}),(0,s._)(this,"errorCallback",()=>{}),(0,s._)(this,"progressCount",0),(0,s._)(this,"progressEstimate",0),(0,s._)(this,"resultMap",new Map([])),(0,s._)(this,"progressTick",async()=>{this.progressCount+=1,this.progressCallback(this.progressCount/this.progressEstimate),await h(1)}),(0,s._)(this,"progressAddEstimate",t=>{this.progressEstimate+=t})}}(0,o.p)(new S)}},e={};function r(s){var a=e[s];if(void 0!==a)return a.exports;var i=e[s]={exports:{}},n=!0;try{t[s](i,i.exports,r),n=!1}finally{n&&delete e[s]}return i.exports}r.m=t,r.x=()=>{var t=r.O(void 0,[802,474],()=>r(8999));return r.O(t)},(()=>{var t=[];r.O=(e,s,a,i)=>{if(s){i=i||0;for(var n=t.length;n>0&&t[n-1][2]>i;n--)t[n]=t[n-1];t[n]=[s,a,i];return}for(var o=1/0,n=0;n<t.length;n++){for(var[s,a,i]=t[n],l=!0,h=0;h<s.length;h++)(!1&i||o>=i)&&Object.keys(r.O).every(t=>r.O[t](s[h]))?s.splice(h--,1):(l=!1,i<o&&(o=i));if(l){t.splice(n--,1);var c=a();void 0!==c&&(e=c)}}return e}})(),r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce((e,s)=>(r.f[s](t,e),e),[])),r.u=t=>802===t?"static/chunks/c448fc67-fe77eb861456862b.js":"static/chunks/"+t+".2f8c031caf48804e.js",r.miniCssF=t=>{},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;r.tt=()=>(void 0===t&&(t={createScriptURL:t=>t},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t)})(),r.tu=t=>r.tt().createScriptURL(t),r.p="/grb2nc.js/_next/",(()=>{var t={999:1};r.f.i=(e,s)=>{t[e]||importScripts(r.tu(r.p+r.u(e)))};var e=self.webpackChunk_N_E=self.webpackChunk_N_E||[],s=e.push.bind(e);e.push=e=>{var[a,i,n]=e;for(var o in i)r.o(i,o)&&(r.m[o]=i[o]);for(n&&n(r);a.length;)t[a.pop()]=1;s(e)}})(),(()=>{var t=r.x;r.x=()=>Promise.all([r.e(802),r.e(474)]).then(t)})(),_N_E=r.x()})();