(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{13:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});var l=n(5155);n(6808);var i=n(9041),a=n(556);function r(){let{progress:e}=(0,a.O)();return e?(0,l.jsx)(i.A,{variant:"determinate",value:100*e}):null}},839:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var l=n(5155),i=n(4647),a=n(5265),r=n(6370),s=n(9496),o=n(2021),c=n(1292),d=n(8955),u=n(2115),h=n(7748),p=n(556);let f=[{fieldName:"feedRateXY",precision:0,step:5,min:1,unitKey:"feedRate"},{fieldName:"plungeSpeed",precision:0,step:5,min:1,unitKey:"feedRate"},{fieldName:"spindleSpeed",precision:0,step:1e3,min:0,unitKey:"rpm"},{fieldName:"cutDepth",precision:2,step:.01,max:0,unitKey:"dimension"},{fieldName:"stepDepth",precision:2,step:.01,min:.01,unitKey:"dimension"},{fieldName:"safeHeight",precision:2,step:.1,min:0,unitKey:"dimension"},{fieldName:"clearanceHeight",precision:2,step:.01,min:0,unitKey:"dimension"},{fieldName:"workHeight",precision:2,step:.01,unitKey:"dimension"},{fieldName:"originOffsetX",precision:2,step:.01,unitKey:"dimension"},{fieldName:"originOffsetY",precision:2,step:.01,unitKey:"dimension"}];var x=n(6444);function m(){let{operationForm:e,machiningOperations:t,updateMachiningOperationParams:n,setOperationForm:m}=(0,p.O)(),g=(0,d.c3)("OperationForm"),[j,A]=(0,u.useState)({}),v=(0,u.useMemo)(()=>{let n=e&&(null==t?void 0:t[e])||null;return n?{...n,...j}:null},[j,t,e]),b=(0,u.useCallback)(e=>t=>{A(n=>({...n,[e]:t}))},[]),F=(0,u.useCallback)(()=>{m(null),A({})},[m]),w=(0,u.useCallback)(()=>{e&&(m(null),n(e,j),A({}))},[j,e,m,n]);return e&&v?(0,l.jsxs)(a.A,{onClose:F,open:!0,children:[(0,l.jsx)(o.A,{children:g("title",{type:e})}),(0,l.jsx)(s.A,{children:(0,l.jsx)(c.A,{direction:"column",gap:2,sx:{pt:2},children:f.map(t=>{let{fieldName:n,precision:i,unitKey:a,step:r,min:s,max:o}=t;return e===x.w.DRILL&&"feedRateXY"===n?null:(0,l.jsx)(h.F,{label:g("fields.".concat(n)),fieldName:n,value:v[n],onChange:b(n),precision:i,step:r,min:s,max:o,unitTranslationKey:a},n)})})}),(0,l.jsxs)(r.A,{children:[(0,l.jsx)(i.A,{variant:"outlined",color:"error",onClick:F,children:g("abort")}),(0,l.jsx)(i.A,{variant:"contained",onClick:w,children:g("save")})]})]}):null}},1855:()=>{},2941:()=>{},3747:(e,t,n)=>{"use strict";n.d(t,{default:()=>S});var l=n(5155),i=n(9518),a=n(5970),r=n(556),s=n(5655),o=n(1665),c=n(7399),d=n(1759),u=n(9170),h=n(8994),p=n(8354),f=n(2265),x=n(9310),m=n(4647),g=n(6205),j=n(1008),A=n(5490),v=n(9250),b=n(2115),F=n(97);let w=(e,t)=>{let{originOffsetX:n,originOffsetY:l,scaleX:i,scaleY:a}=t,r=(n+e.X/i).toFixed(3),s=(l+e.Y/a).toFixed(3);return"X".concat(r," Y").concat(s)},C=(e,t)=>{let{zPasses:n,zDirection:l,stepDepth:i,totalDepth:a,workHeight:r,plungeSpeed:s,feedRateXY:o,clearanceHeight:c}=t,d=[];for(let c=1;c<=n;c+=1){let n=(l*Math.min(c*i,a)+r).toFixed(3);d.push("(Z Pass ".concat(c,": Depth ").concat(n,")"),"G0 ".concat(w(e[0],t)),"G1 Z".concat(n," F").concat(s),...e.map(e=>"G1 ".concat(w(e,t)," F").concat(o)),"G0 Z".concat(r.toFixed(3)))}return d.push("G0 Z".concat(c)),d},k=(e,t,n)=>{let{clearanceHeight:l,safeHeight:i}=n;return["G0 ".concat(w({X:0,Y:0},n)),"M0 tool change required - ".concat(e),"G0 Z".concat(l),...((e,t)=>{let{spindleSpeed:n}=t;return["M3 S".concat(n),"G4 P2",...e,"M5","G4 P2"]})(t,n),"G0 Z".concat(i)]},O=(e,t)=>{let{originOffsetX:n,originOffsetY:l,flipX:i,flipY:a}=t,r=(n+e.X*i).toFixed(3),s=(l+e.Y*a).toFixed(3);return"X".concat(r," Y").concat(s)};var y=n(6444),N=function(e){return e.NONE="none",e.X="x",e.Y="y",e.BOTH="both",e}({}),G=n(8594);function I(e){let{task:t,updateTask:n}=e,{busy:i,setTaskForm:a}=(0,r.O)(),{downloadNCCode:I}=(()=>{let{renderedTasks:e,machiningOperations:t}=(0,r.O)();return{downloadNCCode:(0,b.useCallback)(n=>{let l=e.find(e=>e.fileName===n);if(!l)return;let i=(e=>{let{contours:t,drills:n,params:l,description:i,flip:a,scale:r}=e,s=((e,t,n)=>{let l=e.units,i=Math.sign(parseFloat(e.cutDepth))||-1,a=Math.abs(parseFloat(e.cutDepth)),r=Math.abs(parseFloat(e.stepDepth)),s=Math.ceil(a/r),o=parseFloat(e.originOffsetX),c=parseFloat(e.originOffsetY),d=parseFloat(e.workHeight),u=parseFloat(e.spindleSpeed).toFixed(0),h=parseFloat(e.plungeSpeed).toFixed(3),p=parseFloat(e.feedRateXY).toFixed(3),f=parseFloat(e.safeHeight).toFixed(3),x=parseFloat(e.clearanceHeight).toFixed(3),m=t===N.BOTH||t===N.X?-1:1,g=t===N.BOTH||t===N.Y?-1:1;return{units:l,zDirection:i,zPasses:s,totalDepth:a,stepDepth:r,originOffsetX:o,originOffsetY:c,workHeight:d,spindleSpeed:u,plungeSpeed:h,feedRateXY:p,safeHeight:f,clearanceHeight:x,flipX:m,flipY:g,scaleX:n*m,scaleY:n*g}})(l,a,r),o=[];return t.length&&o.push("","(Contours)","(".concat(i,")"),"",...((e,t)=>{let n=[],{clearanceHeight:l,safeHeight:i}=t;for(let i=0;i<e.length;i++)n.push("","(Contour ".concat(i+1,")"),"G0 Z".concat(l),...C(e[i],t),"G0 Z".concat(l));return[...k("Insert bit/engraver",n,t),"G0 Z".concat(i)]})(t,s)),n.length&&o.push("","(Drills)","(".concat(i,")"),"",...((e,t)=>{let n,l=Object.values((n=e=>e.toString(10),e=>e.reduce((e,t)=>{let l=n(t.r);return e[l]=e[l]||[],e[l].push(t),e},{}))(e)),{safeHeight:i}=t;return["","(Drills: ".concat(l.length," size)"),...l.map(e=>((e,t)=>{let{units:n}=t,l=2*e[0].r;return["","(Drill: ".concat(l).concat(n,")"),...k("Insert ".concat(l).concat(n," drill"),e.map(e=>((e,t)=>{let{units:n,clearanceHeight:l,zPasses:i,zDirection:a,stepDepth:r,totalDepth:s,workHeight:o,plungeSpeed:c}=t,d=2*e.r,u={X:e.cx,Y:e.cy},h=["","(drill ".concat(d).concat(n," at ").concat(O(u,t)," - ").concat(i," passes)"),"G0 ".concat(O(u,t))];for(let e=1;e<=i;e++){let t=(a*Math.min(e*r,s)+o).toFixed(3);h.push("G1 Z".concat(t," F").concat(c),"G0 Z".concat(o.toFixed(3)))}return h.push("G0 Z".concat(l)),h})(e,t)).flat(),t)]})(e,t)).flat(),"G0 Z".concat(i)]})(n,s)),((e,t)=>{let{units:n,safeHeight:l}=t;return["G90","G17",n===y.W.MILLIMETERS?"G21":"G20","G94","G0 Z".concat(l),"G0 ".concat(w({X:0,Y:0},t)),"","",...e,"","","G0 ".concat(w({X:0,Y:0},t)),"M30"]})(o,s).join("\n")})({contours:l.offsetPaths.flat(1),drills:l.drills,flip:l.flip?N.Y:N.BOTH,params:t[l.type],scale:G.G.getScale(),description:"".concat(l.type,' - "').concat(l.fileName,'"')});(0,F.saveAs)(new Blob([i]),"".concat(l.fileName,".nc"))},[t,e])}})(),{fileName:S,type:L}=t,T=(0,b.useMemo)(()=>(e=>{switch(e){case y.w.DRILL:return d.A;case y.w.EDGE_CUT:return s.A;case y.w.ISOLATION:return p.A;default:return()=>null}})(L),[L]);return(0,l.jsxs)(j.Ay,{children:[(0,l.jsx)(A.A,{children:(0,l.jsx)(T,{})}),(0,l.jsx)(v.A,{primary:S}),(0,l.jsxs)(g.A,{variant:"contained",size:"small",disabled:i,sx:{marginLeft:4},children:[(0,l.jsx)(m.A,{onClick:()=>{n(t.fileName,{hidePaths:!t.hidePaths})},children:t.hidePaths?(0,l.jsx)(x.A,{}):(0,l.jsx)(f.A,{})}),(0,l.jsx)(m.A,{onClick:()=>{n(t.fileName,{hideAreas:!t.hideAreas})},children:t.hideAreas?(0,l.jsx)(u.A,{}):(0,l.jsx)(h.A,{})}),(0,l.jsx)(m.A,{disabled:L===y.w.DRILL,onClick:()=>{a(t.fileName)},children:(0,l.jsx)(o.A,{})}),(0,l.jsx)(m.A,{onClick:()=>{I(t.fileName)},children:(0,l.jsx)(c.A,{})})]})]})}function S(){let{tasks:e,updateTask:t}=(0,r.O)();return e.length?(0,l.jsx)(a.A,{children:(0,l.jsx)(i.A,{dense:!0,children:e.map(e=>(0,l.jsx)(I,{task:e,updateTask:t},e.fileName))})}):null}},6808:()=>{},7488:(e,t,n)=>{"use strict";n.d(t,{default:()=>x});var l=n(5155),i=n(5655),a=n(1759),r=n(8354),s=n(4647),o=n(6205),c=n(8955),d=n(556),u=n(2115),h=n(6444);let p=[".gbr",".drl"];function f(){let{activeHandles:e}=(0,d.O)(),t=(0,c.c3)("FileInput"),{canUseFilePicker:n,onFileInputChange:i,requestInputHandle:a}=(()=>{let{tasks:e,setTasks:t,setActiveHandles:n}=(0,d.O)(),[l,i]=(0,u.useState)(),[a,r]=(0,u.useState)(!1);(0,u.useEffect)(()=>{r("function"==typeof window.showOpenFilePicker)},[]);let s=(0,u.useCallback)(async()=>{try{let e=await window.showOpenFilePicker({multiple:!0,types:[{description:"Gerber files",accept:{"text/plain":p}}]});i(e),n(e.length)}catch(e){i([]),n(0)}},[n]),o=(0,u.useCallback)(async e=>{let t,n,l=e.name.toLowerCase(),i=l.split(".").pop()||"";return p.includes(".".concat(i))?("drl"===i?(t=h.w.DRILL,n=!0):l.includes("edge")?(t=h.w.EDGE_CUT,n=!0):l.includes("b_cu")||l.includes("bottom")?(t=h.w.ISOLATION,n=!0):(t=h.w.ISOLATION,n=!1),{fileName:e.name,fileTime:e.lastModified,fileContent:await e.text(),hidePaths:!1,hideAreas:!1,steps:(e=>{switch(e){case h.w.EDGE_CUT:case h.w.ISOLATION:return 1;case h.w.DRILL:return 0}})(t),offset:(e=>{switch(e){case h.w.EDGE_CUT:return 1.5;case h.w.ISOLATION:return .05;case h.w.DRILL:default:return 0}})(t),type:t,flip:n}):null},[]);return(0,u.useEffect)(()=>{if(!(null==l?void 0:l.length))return;let n=async()=>{let n=(await Promise.all(l.map(async e=>{try{let t=await e.getFile();return o(t)}catch(e){return null}}))).filter(Boolean);((e,t)=>{if(e.length!==t.length)return!1;let n=e=>"".concat(e.fileName,"|").concat(e.fileTime),l=new Set(e.map(n)),i=new Set(t.map(n));if(l.size!==i.size)return!1;for(let e of l)if(!i.has(e))return!1;return!0})(e,n)||t(n)},i=window.setInterval(n,2e3);return n(),()=>window.clearInterval(i)},[o,l,t,e]),{canUseFilePicker:a,onFileInputChange:(0,u.useCallback)(async e=>{var n;let l=e.currentTarget;if(!(null==(n=l.files)?void 0:n.length))throw Error("can not read files");let i=await Promise.all([...l.files].map(o));l.value="",t(i.filter(Boolean))},[o,t]),requestInputHandle:s}})(),{busy:r}=(0,d.O)();return(0,l.jsx)("div",{children:n?(0,l.jsx)(s.A,{onClick:a,disabled:r,children:t("watchFiles",{activeHandles:e})}):(0,l.jsxs)(s.A,{component:"label",disabled:r,children:[t("openFiles"),(0,l.jsx)("input",{type:"file",multiple:!0,hidden:!0,disabled:r,onChange:i})]})})}function x(){let{setOperationForm:e,busy:t}=(0,d.O)();return(0,l.jsxs)(o.A,{size:"large",variant:"contained",disabled:t,children:[(0,l.jsx)(f,{}),(0,l.jsx)(s.A,{onClick:()=>e(h.w.ISOLATION),children:(0,l.jsx)(r.A,{})}),(0,l.jsx)(s.A,{onClick:()=>e(h.w.DRILL),children:(0,l.jsx)(a.A,{})}),(0,l.jsx)(s.A,{onClick:()=>e(h.w.EDGE_CUT),children:(0,l.jsx)(i.A,{})})]})}},7748:(e,t,n)=>{"use strict";n.d(t,{F:()=>f});var l=n(5155);n(2941);var i=n(6596),a=n(5057),r=n(4647),s=n(6205),o=n(4782),c=n(1292),d=n(5424),u=n(8955),h=n(2115),p=n(556);function f(e){let{value:t,fieldName:n,onChange:f,label:x,precision:m,unitTranslationKey:g,step:j,min:A,max:v}=e,b=(0,u.c3)("InputField"),{globalUnits:F,busy:w}=(0,p.O)(),[C,k]=(0,h.useState)(t),O="number"==typeof A?A:-1/0,y="number"==typeof v?v:1/0,N=(0,h.useCallback)(e=>{k(e.target.value||"")},[]),G=(0,h.useCallback)(e=>Math.min(y,Math.max(O,e)),[y,O]),I=(0,h.useCallback)(e=>{let t=parseFloat(e);return isNaN(t)?"":G(t).toFixed(m)},[G,m]),S=(0,h.useCallback)(e=>{let t=j||10**(1-m),n=G(parseFloat(C)+(e?1:-1)*t).toFixed(m);k(n),f(n)},[G,C,f,m,j]),L=(0,h.useCallback)(e=>{if(e.target.value){let t=I(e.target.value);k(t),f(t)}},[I,f]);return(0,h.useEffect)(()=>{k(I(t))},[I,t]),(0,l.jsxs)(c.A,{direction:"row",gap:2,children:[(0,l.jsx)(d.A,{fullWidth:!0,autoComplete:"off",disabled:w,id:"field-".concat(n),value:C,onChange:N,onBlur:L,label:x,size:"small",variant:"outlined",slotProps:{input:{endAdornment:(0,l.jsx)(o.A,{position:"end",children:b("units.".concat(g),{globalUnits:F})})},htmlInput:{sx:{textAlign:"right"}}}}),(0,l.jsxs)(s.A,{children:[(0,l.jsx)(r.A,{disabled:w||parseFloat(t)>=y,onClick:()=>S(!0),title:b("buttonLabelIncrease",{value:y.toString(10)}),children:(0,l.jsx)(i.A,{})}),(0,l.jsx)(r.A,{disabled:w||parseFloat(t)<=O,onClick:()=>S(!1),title:b("buttonLabelDecrease",{value:O.toString(10)}),children:(0,l.jsx)(a.A,{})})]})]})}},7816:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});var l=n(5155),i=n(9617),a=n(556);function r(){let{globalErrors:e}=(0,a.O)();return e.length?(0,l.jsx)(l.Fragment,{children:e.map((e,t)=>(0,l.jsx)(i.A,{severity:"error",variant:"filled",children:e},t))}):null}},7833:(e,t,n)=>{Promise.resolve().then(n.bind(n,7816)),Promise.resolve().then(n.bind(n,7488)),Promise.resolve().then(n.bind(n,839)),Promise.resolve().then(n.bind(n,13)),Promise.resolve().then(n.bind(n,7956)),Promise.resolve().then(n.bind(n,3747)),Promise.resolve().then(n.bind(n,9927))},7956:(e,t,n)=>{"use strict";n.d(t,{default:()=>p});var l=n(5155);n(1855);var i=n(2115),a=n(4417),r=n(556),s=n(8594);n(6444);let o=parseInt("1000",10),c=4*o,d=e=>e?(e?e%10:0)*o===c?{stroke:"var(--color-grid-strong)",strokeWidth:(.0075*o).toFixed(2)}:{stroke:"var(--color-grid-regular)",strokeWidth:(.005*o).toFixed(2)}:{stroke:"var(--color-grid-origin)",strokeWidth:(.025*o).toFixed(2)},u=e=>{let t=s.G.getScale();return{left:o*Math.round(e.left/t-4),top:o*Math.round(e.top/t-4),right:o*Math.round(e.right/t+4),bottom:o*Math.round(e.bottom/t+4)}};function h(){let{globalBounds:e,globalUnits:t}=(0,r.O)(),n=u(e),i=n.top,a=n.left,s=n.right,c=n.bottom,h=Math.floor((s-a)/o)+1,p=Math.floor((c-i)/o)+1,f=a/o,x=i/o;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("g",{children:[(0,l.jsx)("circle",{cx:0,cy:0,r:.5*o,fill:"none",...d()}),(0,l.jsx)("text",{x:.3*o,y:.9*o,fill:"var(--color-grid-origin)",style:{fontSize:"".concat(.5*o,"px")},children:t})]}),(0,l.jsx)("g",{children:Array.from({length:h},(e,t)=>(0,l.jsx)("line",{className:"l-".concat(a," i-").concat(t),id:"x-".concat(t,"|").concat(a/o),x1:t*o+a,y1:i,x2:t*o+a,y2:c,...d(t+f)},"x-".concat(t)))}),(0,l.jsx)("g",{children:Array.from({length:p},(e,t)=>(0,l.jsx)("line",{id:"y-".concat(t,"|").concat(i/o),x1:a,y1:t*o+i,x2:s,y2:t*o+i,...d(t+x)},"y-".concat(t,"-").concat(i/o)))})]})}function p(){let{renderedTasks:e,globalBounds:t}=(0,r.O)(),n=(0,i.useMemo)(()=>(e=>{let t=u(e),n=t.left,l=t.top;return[n,l,t.right-t.left,t.bottom-t.top].join(" ")})(t),[t]);return(0,l.jsx)("div",{className:"svg-preview",children:(0,l.jsx)(a.GT,{initialScale:1,minScale:.25,maxScale:10,limitToBounds:!1,centerZoomedOut:!1,centerOnInit:!0,children:(0,l.jsx)(a.WZ,{children:(0,l.jsxs)("svg",{className:"svg-preview__svg",viewBox:n,children:[(0,l.jsx)(h,{}),e.map((e,t)=>{let{svgPathProps:n}=e;return(0,l.jsx)("g",{children:n.map((e,n)=>{let{path:i,fill:a,stroke:r,strokeWidth:s,hide:o}=e;return!o&&(0,l.jsx)("path",{fill:a,stroke:r,strokeWidth:s,d:i},"p-".concat(t,"-").concat(n))})},"g-".concat(t))})]})})})})}},9927:(e,t,n)=>{"use strict";n.d(t,{default:()=>x});var l=n(5155),i=n(4647),a=n(5265),r=n(6370),s=n(9496),o=n(2021),c=n(1292),d=n(8955),u=n(2115),h=n(7748),p=n(556),f=n(6444);function x(){let{taskForm:e,tasks:t,updateTask:n,setTaskForm:x}=(0,p.O)(),m=(0,d.c3)("TaskParamsForm"),[g,j]=(0,u.useState)({}),A=(0,u.useMemo)(()=>e&&t.find(t=>{let{fileName:n}=t;return n===e})||null,[e,t]),v=(0,u.useMemo)(()=>A?{...A,...g}:null,[g,A]),b=(0,u.useCallback)(e=>t=>{j(n=>({...n,[e]:parseFloat(t)}))},[]),F=(0,u.useCallback)(()=>{x(""),j({})},[x]),w=(0,u.useCallback)(()=>{e&&(x(""),n(e,g),j({}))},[g,x,e,n]);if(!A||!v)return null;let{type:C}=A;return(0,l.jsxs)(a.A,{onClose:F,open:!0,children:[(0,l.jsx)(o.A,{children:m("title",{fileName:A.fileName})}),(0,l.jsx)(s.A,{children:v&&(0,l.jsxs)(c.A,{direction:"column",gap:2,sx:{pt:2},children:[C===f.w.ISOLATION&&(0,l.jsx)(h.F,{label:"Steps",fieldName:"".concat(C,"-steps"),value:v.steps.toFixed(0),precision:0,step:1,min:0,max:10,unitTranslationKey:"none",onChange:b("steps")}),C!==f.w.DRILL&&(0,l.jsx)(h.F,{label:"Offset",fieldName:"".concat(C,"-offset"),value:v.offset.toFixed(2),precision:2,step:.01,min:0,max:5,unitTranslationKey:"dimension",onChange:b("offset")})]})}),(0,l.jsxs)(r.A,{children:[(0,l.jsx)(i.A,{variant:"outlined",color:"error",onClick:F,children:m("abort")}),(0,l.jsx)(i.A,{variant:"contained",onClick:w,children:m("save")})]})]})}}},e=>{e.O(0,[291,802,831,884,556,441,255,358],()=>e(e.s=7833)),_N_E=e.O()}]);